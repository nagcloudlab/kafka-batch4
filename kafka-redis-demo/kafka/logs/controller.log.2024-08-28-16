[2024-08-28 16:00:44,522] INFO [QuorumController id=2] Replayed initial RegisterBrokerRecord for broker 4: RegisterBrokerRecord(brokerId=4, isMigratingZkBroker=false, incarnationId=6WEO2HBXSHSbeyLYydtcPA, brokerEpoch=436, endPoints=[BrokerEndpoint(name='PLAINTEXT', host='localhost', port=9095, securityProtocol=0)], features=[BrokerFeature(name='metadata.version', minSupportedVersion=1, maxSupportedVersion=19)], rack=null, fenced=true, inControlledShutdown=false, logDirs=[0Q1sVXRujAt3sLdeTM523g]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:00:45,032] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 4: BrokerRegistrationChangeRecord(brokerId=4, brokerEpoch=436, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:01:23,228] INFO [QuorumController id=2] Replayed TopicRecord for topic test-topic with topic ID G88lmuALTVq2cKfkmey8EA. (org.apache.kafka.controller.ReplicationControlManager)
[2024-08-28 16:01:23,231] INFO [QuorumController id=2] Replayed ConfigRecord for ConfigResource(type=TOPIC, name='test-topic') which set configuration cleanup.policy to delete (org.apache.kafka.controller.ConfigurationControlManager)
[2024-08-28 16:01:23,235] INFO [QuorumController id=2] Replayed PartitionRecord for new partition test-topic-0 with topic ID G88lmuALTVq2cKfkmey8EA and PartitionRegistration(replicas=[1], directories=[OYcSi161t-sCsLTaxvBb7g], isr=[1], removingReplicas=[], addingReplicas=[], elr=[], lastKnownElr=[], leader=1, leaderRecoveryState=RECOVERED, leaderEpoch=0, partitionEpoch=0). (org.apache.kafka.controller.ReplicationControlManager)
[2024-08-28 16:01:23,242] INFO [QuorumController id=2] Replayed PartitionRecord for new partition test-topic-1 with topic ID G88lmuALTVq2cKfkmey8EA and PartitionRegistration(replicas=[2], directories=[jmjpr0EIBUCmfoQ2L0Mfag], isr=[2], removingReplicas=[], addingReplicas=[], elr=[], lastKnownElr=[], leader=2, leaderRecoveryState=RECOVERED, leaderEpoch=0, partitionEpoch=0). (org.apache.kafka.controller.ReplicationControlManager)
[2024-08-28 16:01:23,253] INFO [QuorumController id=2] Replayed PartitionRecord for new partition test-topic-2 with topic ID G88lmuALTVq2cKfkmey8EA and PartitionRegistration(replicas=[3], directories=[4gi_yG2oVoDL34GeyHnVXQ], isr=[3], removingReplicas=[], addingReplicas=[], elr=[], lastKnownElr=[], leader=3, leaderRecoveryState=RECOVERED, leaderEpoch=0, partitionEpoch=0). (org.apache.kafka.controller.ReplicationControlManager)
[2024-08-28 16:02:41,958] INFO [QuorumController id=2] Replaying ProducerIdsRecord ProducerIdsRecord(brokerId=1, brokerEpoch=6, nextProducerId=1000) (org.apache.kafka.controller.ProducerIdControlManager)
[2024-08-28 16:02:42,153] INFO [QuorumController id=2] Replaying ProducerIdsRecord ProducerIdsRecord(brokerId=3, brokerEpoch=37, nextProducerId=2000) (org.apache.kafka.controller.ProducerIdControlManager)
[2024-08-28 16:05:48,194] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 3: BrokerRegistrationChangeRecord(brokerId=3, brokerEpoch=37, fenced=0, inControlledShutdown=1, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:05:52,209] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 3: BrokerRegistrationChangeRecord(brokerId=3, brokerEpoch=37, fenced=1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,055] INFO [QuorumController id=3] Creating new QuorumController with clusterId reLhSuUYT7mJU5JUvLaWCQ. (org.apache.kafka.controller.QuorumController)
[2024-08-28 16:06:00,058] INFO [QuorumController id=3] In the new epoch 6, the leader is 1. (org.apache.kafka.controller.QuorumController)
[2024-08-28 16:06:00,107] INFO [QuorumController id=3] Replayed BeginTransactionRecord(name='Bootstrap records') at offset 1. (org.apache.kafka.controller.OffsetControlManager)
[2024-08-28 16:06:00,108] INFO [QuorumController id=3] Replayed a FeatureLevelRecord setting metadata version to 3.7-IV4 (org.apache.kafka.controller.FeatureControlManager)
[2024-08-28 16:06:00,108] INFO [QuorumController id=3] Replayed EndTransactionRecord() at offset 4. (org.apache.kafka.controller.OffsetControlManager)
[2024-08-28 16:06:00,111] INFO [QuorumController id=3] Replayed initial RegisterBrokerRecord for broker 2: RegisterBrokerRecord(brokerId=2, isMigratingZkBroker=false, incarnationId=miLB_7ynQveV-RMFy0F1Yw, brokerEpoch=5, endPoints=[BrokerEndpoint(name='PLAINTEXT', host='localhost', port=9093, securityProtocol=0)], features=[BrokerFeature(name='metadata.version', minSupportedVersion=1, maxSupportedVersion=19)], rack=null, fenced=true, inControlledShutdown=false, logDirs=[jmjpr0EIBUCmfoQ2L0Mfag]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,111] INFO [QuorumController id=3] Replayed initial RegisterBrokerRecord for broker 1: RegisterBrokerRecord(brokerId=1, isMigratingZkBroker=false, incarnationId=z-UlhTx7T5iiOuSmIN81IQ, brokerEpoch=6, endPoints=[BrokerEndpoint(name='PLAINTEXT', host='localhost', port=9092, securityProtocol=0)], features=[BrokerFeature(name='metadata.version', minSupportedVersion=1, maxSupportedVersion=19)], rack=null, fenced=true, inControlledShutdown=false, logDirs=[OYcSi161t-sCsLTaxvBb7g]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,117] INFO [QuorumController id=3] Replayed RegisterControllerRecord contaning ControllerRegistration(id=1, incarnationId=fxzJnS8yRBCbzAvLjTI7lg, zkMigrationReady=false, listeners=[Endpoint(listenerName='CONTROLLER', securityProtocol=PLAINTEXT, host='localhost', port=19092)], supportedFeatures={metadata.version: 1-19}). (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,120] INFO [QuorumController id=3] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 1: BrokerRegistrationChangeRecord(brokerId=1, brokerEpoch=6, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,120] INFO [QuorumController id=3] Replayed RegisterControllerRecord contaning ControllerRegistration(id=2, incarnationId=J_Y2KNOiRJ21JKEViFd8-g, zkMigrationReady=false, listeners=[Endpoint(listenerName='CONTROLLER', securityProtocol=PLAINTEXT, host='localhost', port=19093)], supportedFeatures={metadata.version: 1-19}). (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,120] INFO [QuorumController id=3] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 2: BrokerRegistrationChangeRecord(brokerId=2, brokerEpoch=5, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,121] INFO [QuorumController id=3] Replayed initial RegisterBrokerRecord for broker 3: RegisterBrokerRecord(brokerId=3, isMigratingZkBroker=false, incarnationId=AOKBu_8pR7iz1mL30cYw3g, brokerEpoch=37, endPoints=[BrokerEndpoint(name='PLAINTEXT', host='localhost', port=9094, securityProtocol=0)], features=[BrokerFeature(name='metadata.version', minSupportedVersion=1, maxSupportedVersion=19)], rack=null, fenced=true, inControlledShutdown=false, logDirs=[4gi_yG2oVoDL34GeyHnVXQ]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,122] INFO [QuorumController id=3] Replayed RegisterControllerRecord contaning ControllerRegistration(id=3, incarnationId=AzouxZ-jTFGJM2MA6D6eWw, zkMigrationReady=false, listeners=[Endpoint(listenerName='CONTROLLER', securityProtocol=PLAINTEXT, host='localhost', port=19094)], supportedFeatures={metadata.version: 1-19}). (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,122] INFO [QuorumController id=3] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 3: BrokerRegistrationChangeRecord(brokerId=3, brokerEpoch=37, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,138] INFO [QuorumController id=3] Replayed initial RegisterBrokerRecord for broker 4: RegisterBrokerRecord(brokerId=4, isMigratingZkBroker=false, incarnationId=6WEO2HBXSHSbeyLYydtcPA, brokerEpoch=436, endPoints=[BrokerEndpoint(name='PLAINTEXT', host='localhost', port=9095, securityProtocol=0)], features=[BrokerFeature(name='metadata.version', minSupportedVersion=1, maxSupportedVersion=19)], rack=null, fenced=true, inControlledShutdown=false, logDirs=[0Q1sVXRujAt3sLdeTM523g]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,138] INFO [QuorumController id=3] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 4: BrokerRegistrationChangeRecord(brokerId=4, brokerEpoch=436, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,143] INFO [QuorumController id=3] Replayed TopicRecord for topic test-topic with topic ID G88lmuALTVq2cKfkmey8EA. (org.apache.kafka.controller.ReplicationControlManager)
[2024-08-28 16:06:00,143] INFO [QuorumController id=3] Replayed ConfigRecord for ConfigResource(type=TOPIC, name='test-topic') which set configuration cleanup.policy to delete (org.apache.kafka.controller.ConfigurationControlManager)
[2024-08-28 16:06:00,145] INFO [QuorumController id=3] Replayed PartitionRecord for new partition test-topic-0 with topic ID G88lmuALTVq2cKfkmey8EA and PartitionRegistration(replicas=[1], directories=[OYcSi161t-sCsLTaxvBb7g], isr=[1], removingReplicas=[], addingReplicas=[], elr=[], lastKnownElr=[], leader=1, leaderRecoveryState=RECOVERED, leaderEpoch=0, partitionEpoch=0). (org.apache.kafka.controller.ReplicationControlManager)
[2024-08-28 16:06:00,147] INFO [QuorumController id=3] Replayed PartitionRecord for new partition test-topic-1 with topic ID G88lmuALTVq2cKfkmey8EA and PartitionRegistration(replicas=[2], directories=[jmjpr0EIBUCmfoQ2L0Mfag], isr=[2], removingReplicas=[], addingReplicas=[], elr=[], lastKnownElr=[], leader=2, leaderRecoveryState=RECOVERED, leaderEpoch=0, partitionEpoch=0). (org.apache.kafka.controller.ReplicationControlManager)
[2024-08-28 16:06:00,147] INFO [QuorumController id=3] Replayed PartitionRecord for new partition test-topic-2 with topic ID G88lmuALTVq2cKfkmey8EA and PartitionRegistration(replicas=[3], directories=[4gi_yG2oVoDL34GeyHnVXQ], isr=[3], removingReplicas=[], addingReplicas=[], elr=[], lastKnownElr=[], leader=3, leaderRecoveryState=RECOVERED, leaderEpoch=0, partitionEpoch=0). (org.apache.kafka.controller.ReplicationControlManager)
[2024-08-28 16:06:00,152] INFO [QuorumController id=3] Replaying ProducerIdsRecord ProducerIdsRecord(brokerId=1, brokerEpoch=6, nextProducerId=1000) (org.apache.kafka.controller.ProducerIdControlManager)
[2024-08-28 16:06:00,153] INFO [QuorumController id=3] Replaying ProducerIdsRecord ProducerIdsRecord(brokerId=3, brokerEpoch=37, nextProducerId=2000) (org.apache.kafka.controller.ProducerIdControlManager)
[2024-08-28 16:06:00,163] INFO [QuorumController id=3] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 3: BrokerRegistrationChangeRecord(brokerId=3, brokerEpoch=37, fenced=0, inControlledShutdown=1, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,163] INFO [QuorumController id=3] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 3: BrokerRegistrationChangeRecord(brokerId=3, brokerEpoch=37, fenced=1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,436] INFO [QuorumController id=2] Replayed RegisterControllerRecord contaning ControllerRegistration(id=3, incarnationId=dfhS8tdNRPuZRjsAzzR1MQ, zkMigrationReady=false, listeners=[Endpoint(listenerName='CONTROLLER', securityProtocol=PLAINTEXT, host='localhost', port=19094)], supportedFeatures={metadata.version: 1-19}). Previous incarnation was AzouxZ-jTFGJM2MA6D6eWw (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,451] INFO [QuorumController id=3] Replayed RegisterControllerRecord contaning ControllerRegistration(id=3, incarnationId=dfhS8tdNRPuZRjsAzzR1MQ, zkMigrationReady=false, listeners=[Endpoint(listenerName='CONTROLLER', securityProtocol=PLAINTEXT, host='localhost', port=19094)], supportedFeatures={metadata.version: 1-19}). Previous incarnation was AzouxZ-jTFGJM2MA6D6eWw (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,771] INFO [QuorumController id=2] Replayed RegisterBrokerRecord establishing a new incarnation of broker 3: RegisterBrokerRecord(brokerId=3, isMigratingZkBroker=false, incarnationId=LSAX-Xr6Skqt3G9hA8EdpQ, brokerEpoch=1078, endPoints=[BrokerEndpoint(name='PLAINTEXT', host='localhost', port=9094, securityProtocol=0)], features=[BrokerFeature(name='metadata.version', minSupportedVersion=1, maxSupportedVersion=19)], rack=null, fenced=true, inControlledShutdown=false, logDirs=[4gi_yG2oVoDL34GeyHnVXQ]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:00,782] INFO [QuorumController id=3] Replayed RegisterBrokerRecord establishing a new incarnation of broker 3: RegisterBrokerRecord(brokerId=3, isMigratingZkBroker=false, incarnationId=LSAX-Xr6Skqt3G9hA8EdpQ, brokerEpoch=1078, endPoints=[BrokerEndpoint(name='PLAINTEXT', host='localhost', port=9094, securityProtocol=0)], features=[BrokerFeature(name='metadata.version', minSupportedVersion=1, maxSupportedVersion=19)], rack=null, fenced=true, inControlledShutdown=false, logDirs=[4gi_yG2oVoDL34GeyHnVXQ]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:01,274] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 3: BrokerRegistrationChangeRecord(brokerId=3, brokerEpoch=1078, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:06:01,285] INFO [QuorumController id=3] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 3: BrokerRegistrationChangeRecord(brokerId=3, brokerEpoch=1078, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:42:32,117] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 4: BrokerRegistrationChangeRecord(brokerId=4, brokerEpoch=436, fenced=1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:42:32,127] INFO [QuorumController id=3] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 4: BrokerRegistrationChangeRecord(brokerId=4, brokerEpoch=436, fenced=1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:42:34,137] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 3: BrokerRegistrationChangeRecord(brokerId=3, brokerEpoch=1078, fenced=0, inControlledShutdown=1, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:42:34,148] INFO [QuorumController id=3] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 3: BrokerRegistrationChangeRecord(brokerId=3, brokerEpoch=1078, fenced=0, inControlledShutdown=1, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:42:35,639] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 2: BrokerRegistrationChangeRecord(brokerId=2, brokerEpoch=5, fenced=0, inControlledShutdown=1, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:42:35,650] INFO [QuorumController id=3] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 2: BrokerRegistrationChangeRecord(brokerId=2, brokerEpoch=5, fenced=0, inControlledShutdown=1, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:42:36,606] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 3: BrokerRegistrationChangeRecord(brokerId=3, brokerEpoch=1078, fenced=1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:42:37,286] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 1: BrokerRegistrationChangeRecord(brokerId=1, brokerEpoch=6, fenced=0, inControlledShutdown=1, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:42:37,538] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 1: BrokerRegistrationChangeRecord(brokerId=1, brokerEpoch=6, fenced=1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-08-28 16:42:37,594] INFO [QuorumController id=2] In the new epoch 7, the leader is (none). (org.apache.kafka.controller.QuorumController)
[2024-08-28 16:42:37,909] INFO [QuorumController id=2] Becoming the active controller at epoch 7, next write offset 5461. (org.apache.kafka.controller.QuorumController)
[2024-08-28 16:42:37,913] WARN [QuorumController id=2] Performing controller activation. Loaded ZK migration state of NONE. (org.apache.kafka.controller.QuorumController)
[2024-08-28 16:42:38,419] INFO [QuorumController id=2] writeNoOpRecord: event failed with NotLeaderException (treated as NotControllerException) at epoch 7 in 1732 microseconds. Renouncing leadership and reverting to the last committed offset 5458. Exception message: Append failed because the replication is not the current leader (org.apache.kafka.controller.QuorumController)
