[2024-09-04 16:02:39,744] INFO [SnapshotGenerator id=101] Creating new KRaft snapshot file snapshot 00000000000000007293-0000000004 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2024-09-04 16:02:39,944] INFO [SnapshotEmitter id=101] Successfully wrote snapshot 00000000000000007293-0000000004 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2024-09-04 16:40:26,015] INFO [RaftManager id=101] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are []. (org.apache.kafka.raft.LeaderState)
[2024-09-04 16:40:26,019] INFO [RaftManager id=101] Completed transition to ResignedState(localId=101, epoch=4, voters=[101, 102, 103], electionTimeoutMs=1301, unackedVoters=[102, 103], preferredSuccessors=[102, 103]) from Leader(localId=101, epoch=4, epochStartOffset=0, highWatermark=Optional[LogOffsetMetadata(offset=10156, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=736406)])], voterStates={101=ReplicaState(nodeId=101, endOffset=Optional[LogOffsetMetadata(offset=10156, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=736406)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 102=ReplicaState(nodeId=102, endOffset=Optional[LogOffsetMetadata(offset=10156, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=736406)])], lastFetchTimestamp=1725447399523, lastCaughtUpTimestamp=1725447399523, hasAcknowledgedLeader=true), 103=ReplicaState(nodeId=103, endOffset=Optional[LogOffsetMetadata(offset=10156, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=736406)])], lastFetchTimestamp=1725447399509, lastCaughtUpTimestamp=1725447399509, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2024-09-04 16:40:27,157] INFO [QuorumController id=101] failAll(NotControllerException): failing writeNoOpRecord(971181615). (org.apache.kafka.deferred.DeferredEventQueue)
[2024-09-04 16:40:27,159] INFO [QuorumController id=101] failAll(NotControllerException): failing processBrokerHeartbeat(864143541). (org.apache.kafka.deferred.DeferredEventQueue)
[2024-09-04 16:40:27,163] INFO [QuorumController id=101] failAll(NotControllerException): failing maybeFenceReplicas(412432941). (org.apache.kafka.deferred.DeferredEventQueue)
[2024-09-04 16:40:27,174] INFO [QuorumController id=101] failAll(NotControllerException): failing processBrokerHeartbeat(1294781513). (org.apache.kafka.deferred.DeferredEventQueue)
[2024-09-04 16:40:27,174] INFO [QuorumController id=101] failAll(NotControllerException): failing processBrokerHeartbeat(1813979573). (org.apache.kafka.deferred.DeferredEventQueue)
[2024-09-04 16:40:27,180] INFO [NodeToControllerChannelManager id=101 name=heartbeat] Client requested disconnect from node 101 (org.apache.kafka.clients.NetworkClient)
[2024-09-04 16:40:27,219] INFO [RaftManager id=101] Completed transition to Unattached(epoch=5, voters=[101, 102, 103], electionTimeoutMs=1290) from ResignedState(localId=101, epoch=4, voters=[101, 102, 103], electionTimeoutMs=1301, unackedVoters=[], preferredSuccessors=[102, 103]) (org.apache.kafka.raft.QuorumState)
[2024-09-04 16:40:27,320] INFO [RaftManager id=101] Completed transition to Voted(epoch=5, votedId=103, voters=[101, 102, 103], electionTimeoutMs=1661) from Unattached(epoch=5, voters=[101, 102, 103], electionTimeoutMs=1290) (org.apache.kafka.raft.QuorumState)
[2024-09-04 16:40:27,320] INFO [RaftManager id=101] Vote request VoteRequestData(clusterId='reLhSuUYT7mJU5JUvLaWCQ', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5, candidateId=103, lastOffsetEpoch=4, lastOffset=10156)])]) with epoch 5 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2024-09-04 16:40:27,321] INFO [RaftManager id=101] Vote request VoteRequestData(clusterId='reLhSuUYT7mJU5JUvLaWCQ', topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5, candidateId=102, lastOffsetEpoch=4, lastOffset=10156)])]) with epoch 5 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2024-09-04 16:40:27,383] INFO [RaftManager id=101] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=5, leaderId=103, voters=[101, 102, 103], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Voted(epoch=5, votedId=103, voters=[101, 102, 103], electionTimeoutMs=1661) (org.apache.kafka.raft.QuorumState)
[2024-09-04 16:40:27,408] INFO [broker-101-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:19094 (id: 103 rack: null) (kafka.server.NodeToControllerRequestThread)
[2024-09-04 16:40:27,410] INFO [NodeToControllerChannelManager id=101 name=heartbeat] Client requested disconnect from node 103 (org.apache.kafka.clients.NetworkClient)
[2024-09-04 16:40:27,410] INFO [broker-101-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:19094 (id: 103 rack: null) (kafka.server.NodeToControllerRequestThread)
[2024-09-04 16:40:27,460] INFO [broker-101-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:19094 (id: 103 rack: null) (kafka.server.NodeToControllerRequestThread)
[2024-09-04 16:40:27,931] INFO [RaftManager id=101] High watermark set to Optional[LogOffsetMetadata(offset=10157, metadata=Optional.empty)] for the first time for epoch 5 (org.apache.kafka.raft.FollowerState)
[2024-09-04 16:51:44,450] INFO [RaftManager id=101] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2024-09-04 16:51:44,487] INFO [RaftManager id=101] Completed transition to CandidateState(localId=101, epoch=6, retries=1, voteStates={101=GRANTED, 102=UNRECORDED, 103=UNRECORDED}, highWatermark=Optional[LogOffsetMetadata(offset=11119, metadata=Optional.empty)], electionTimeoutMs=1542) from FollowerState(fetchTimeoutMs=2000, epoch=5, leaderId=103, voters=[101, 102, 103], highWatermark=Optional[LogOffsetMetadata(offset=11119, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2024-09-04 16:51:44,515] INFO [NodeToControllerChannelManager id=101 name=heartbeat] Client requested disconnect from node 103 (org.apache.kafka.clients.NetworkClient)
[2024-09-04 16:51:44,575] INFO [RaftManager id=101] Completed transition to Leader(localId=101, epoch=6, epochStartOffset=11119, highWatermark=Optional.empty, voterStates={101=ReplicaState(nodeId=101, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 102=ReplicaState(nodeId=102, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 103=ReplicaState(nodeId=103, endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=101, epoch=6, retries=1, voteStates={101=GRANTED, 102=GRANTED, 103=UNRECORDED}, highWatermark=Optional[LogOffsetMetadata(offset=11119, metadata=Optional.empty)], electionTimeoutMs=1542) (org.apache.kafka.raft.QuorumState)
[2024-09-04 16:51:44,619] INFO [broker-101-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:19092 (id: 101 rack: null) (kafka.server.NodeToControllerRequestThread)
[2024-09-04 16:51:44,680] INFO [RaftManager id=101] High watermark set to LogOffsetMetadata(offset=11120, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=805882)]) for the first time for epoch 6 based on indexOfHw 1 and voters [ReplicaState(nodeId=101, endOffset=Optional[LogOffsetMetadata(offset=11120, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=805882)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(nodeId=102, endOffset=Optional[LogOffsetMetadata(offset=11120, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=805882)])], lastFetchTimestamp=1725448904680, lastCaughtUpTimestamp=1725448904680, hasAcknowledgedLeader=true), ReplicaState(nodeId=103, endOffset=Optional[LogOffsetMetadata(offset=11119, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=805776)])], lastFetchTimestamp=1725448904640, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2024-09-04 16:51:44,691] INFO [NodeToControllerChannelManager id=101 name=heartbeat] Client requested disconnect from node 101 (org.apache.kafka.clients.NetworkClient)
[2024-09-04 16:51:44,691] INFO [broker-101-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:19092 (id: 101 rack: null) (kafka.server.NodeToControllerRequestThread)
[2024-09-04 16:51:44,742] INFO [broker-101-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node localhost:19092 (id: 101 rack: null) (kafka.server.NodeToControllerRequestThread)
