[2024-08-21 15:00:51,244] INFO [Controller id=101 epoch=1] Changed partition topic1-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=101, leaderEpoch=1, isrWithBrokerEpoch=List(BrokerState(brokerId=101, brokerEpoch=-1), BrokerState(brokerId=103, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=1) (state.change.logger)
[2024-08-21 15:00:51,245] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 101 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 15:00:51,245] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 102 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 15:00:51,245] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 103 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 15:00:51,245] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 1 partitions (state.change.logger)
[2024-08-21 15:00:51,246] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 34 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 15:00:51,246] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 15:00:51,246] INFO [Controller id=101 epoch=1] Sending StopReplica request for 2 replicas to broker 102 (state.change.logger)
[2024-08-21 15:00:51,248] INFO [Broker id=101] Stopped fetchers as part of LeaderAndIsr request correlationId 34 from controller 101 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-08-21 15:00:51,248] INFO [Broker id=101] Leader topic1-1 with topic id Some(vME4OcIKTTO1lNGoKNRTqg) starts at leader epoch 1 from offset 0 with partition epoch 1, high watermark 0, ISR [101,103], adding replicas [] and removing replicas [] . Previous leader Some(102) and previous leader epoch was 0. (state.change.logger)
[2024-08-21 15:00:51,264] INFO [Controller id=101 epoch=1] Partition topic1-0 state changed to (Leader:103,ISR:103,101,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:00:51,265] INFO [Controller id=101 epoch=1] Partition topic1-2 state changed to (Leader:101,ISR:101,103,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:00:51,265] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 101 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 15:00:51,265] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 103 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 15:00:51,266] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 2 partitions (state.change.logger)
[2024-08-21 15:00:51,274] INFO [Controller id=101 epoch=1] Sending StopReplica request for 2 replicas to broker 102 (state.change.logger)
[2024-08-21 15:00:51,277] INFO [Broker id=101] Finished LeaderAndIsr request in 31ms correlationId 34 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 15:00:51,278] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 35 (state.change.logger)
[2024-08-21 15:00:51,279] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 36 from controller 101 for 2 partitions (state.change.logger)
[2024-08-21 15:00:51,279] INFO [Broker id=101] Stopped fetchers as part of LeaderAndIsr request correlationId 36 from controller 101 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-08-21 15:00:51,279] INFO [Broker id=101] Leader topic1-2 with topic id Some(vME4OcIKTTO1lNGoKNRTqg) starts at leader epoch 1 from offset 0 with partition epoch 1, high watermark 0, ISR [101,103], adding replicas [] and removing replicas [] . Previous leader Some(101) and previous leader epoch was 0. (state.change.logger)
[2024-08-21 15:00:51,296] INFO [Broker id=101] Follower topic1-0 starts at leader epoch 1 from offset 1 with partition epoch 1 and high watermark 1. Current leader is 103. Previous leader Some(103) and previous leader epoch was 1. (state.change.logger)
[2024-08-21 15:00:51,297] INFO [Broker id=101] Stopped fetchers as part of become-follower request from controller 101 epoch 1 with correlation id 36 for 1 partitions (state.change.logger)
[2024-08-21 15:00:51,299] INFO [Broker id=101] Finished LeaderAndIsr request in 20ms correlationId 36 from controller 101 for 2 partitions (state.change.logger)
[2024-08-21 15:00:51,300] INFO [Broker id=101] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 37 (state.change.logger)
[2024-08-21 15:00:51,515] INFO [Controller id=101 epoch=1] Partition topic1-1 state changed to (Leader:101,ISR:101,103,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:00:51,515] INFO [Controller id=101 epoch=1] Partition topic1-0 state changed to (Leader:103,ISR:103,101,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:00:51,515] INFO [Controller id=101 epoch=1] Partition topic1-2 state changed to (Leader:101,ISR:101,103,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:00:51,515] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 101 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 15:00:51,516] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 103 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-08-21 15:00:51,516] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 103) for 3 partitions (state.change.logger)
[2024-08-21 15:00:51,516] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 38 from controller 101 for 3 partitions (state.change.logger)
[2024-08-21 15:00:51,518] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 101 with correlation id 38 epoch 1 for partition topic1-1 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-08-21 15:00:51,518] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 101 with correlation id 38 epoch 1 for partition topic1-0 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-08-21 15:00:51,518] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 101 with correlation id 38 epoch 1 for partition topic1-2 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-08-21 15:00:51,518] INFO [Broker id=101] Finished LeaderAndIsr request in 2ms correlationId 38 from controller 101 for 3 partitions (state.change.logger)
[2024-08-21 15:00:51,519] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 39 (state.change.logger)
[2024-08-21 15:01:39,065] INFO [Controller id=101 epoch=1] Changed partition topic1-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=101, leaderEpoch=2, isrWithBrokerEpoch=List(BrokerState(brokerId=101, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=2) (state.change.logger)
[2024-08-21 15:01:39,066] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 101 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 15:01:39,066] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 103 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 15:01:39,067] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 103) for 1 partitions (state.change.logger)
[2024-08-21 15:01:39,067] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 40 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 15:01:39,067] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 15:01:39,067] INFO [Controller id=101 epoch=1] Sending StopReplica request for 2 replicas to broker 103 (state.change.logger)
[2024-08-21 15:01:39,067] INFO [Broker id=101] Stopped fetchers as part of LeaderAndIsr request correlationId 40 from controller 101 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-08-21 15:01:39,067] INFO [Broker id=101] Leader topic1-0 with topic id Some(vME4OcIKTTO1lNGoKNRTqg) starts at leader epoch 2 from offset 2 with partition epoch 2, high watermark 2, ISR [101], adding replicas [] and removing replicas [] . Previous leader Some(103) and previous leader epoch was 1. (state.change.logger)
[2024-08-21 15:01:39,081] INFO [Broker id=101] Finished LeaderAndIsr request in 14ms correlationId 40 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 15:01:39,082] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 41 (state.change.logger)
[2024-08-21 15:01:39,088] INFO [Controller id=101 epoch=1] Partition topic1-1 state changed to (Leader:101,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:01:39,089] INFO [Controller id=101 epoch=1] Partition topic1-2 state changed to (Leader:101,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:01:39,089] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 101 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 15:01:39,089] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 103) for 2 partitions (state.change.logger)
[2024-08-21 15:01:39,089] INFO [Controller id=101 epoch=1] Sending StopReplica request for 2 replicas to broker 103 (state.change.logger)
[2024-08-21 15:01:39,089] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 42 from controller 101 for 2 partitions (state.change.logger)
[2024-08-21 15:01:39,090] INFO [Broker id=101] Stopped fetchers as part of LeaderAndIsr request correlationId 42 from controller 101 epoch 1 as part of the become-leader transition for 2 partitions (state.change.logger)
[2024-08-21 15:01:39,090] INFO [Broker id=101] Leader topic1-1 with topic id Some(vME4OcIKTTO1lNGoKNRTqg) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [101], adding replicas [] and removing replicas [] . Previous leader Some(101) and previous leader epoch was 1. (state.change.logger)
[2024-08-21 15:01:39,108] INFO [Broker id=101] Leader topic1-2 with topic id Some(vME4OcIKTTO1lNGoKNRTqg) starts at leader epoch 2 from offset 0 with partition epoch 2, high watermark 0, ISR [101], adding replicas [] and removing replicas [] . Previous leader Some(101) and previous leader epoch was 1. (state.change.logger)
[2024-08-21 15:01:39,120] INFO [Broker id=101] Finished LeaderAndIsr request in 30ms correlationId 42 from controller 101 for 2 partitions (state.change.logger)
[2024-08-21 15:01:39,121] INFO [Broker id=101] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 43 (state.change.logger)
[2024-08-21 15:01:39,288] INFO [Controller id=101 epoch=1] Partition topic1-1 state changed to (Leader:101,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:01:39,289] INFO [Controller id=101 epoch=1] Partition topic1-0 state changed to (Leader:101,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:01:39,289] INFO [Controller id=101 epoch=1] Partition topic1-2 state changed to (Leader:101,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:01:39,289] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 101 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 15:01:39,289] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101) for 3 partitions (state.change.logger)
[2024-08-21 15:01:39,290] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 44 from controller 101 for 3 partitions (state.change.logger)
[2024-08-21 15:01:39,290] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 101 with correlation id 44 epoch 1 for partition topic1-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2024-08-21 15:01:39,290] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 101 with correlation id 44 epoch 1 for partition topic1-0 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2024-08-21 15:01:39,290] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 101 with correlation id 44 epoch 1 for partition topic1-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2024-08-21 15:01:39,290] INFO [Broker id=101] Finished LeaderAndIsr request in 0ms correlationId 44 from controller 101 for 3 partitions (state.change.logger)
[2024-08-21 15:01:39,291] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 45 (state.change.logger)
[2024-08-21 15:02:58,794] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101) for 0 partitions (state.change.logger)
[2024-08-21 15:02:58,794] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(102) for 3 partitions (state.change.logger)
[2024-08-21 15:02:58,795] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 102 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-08-21 15:02:58,796] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102) for 3 partitions (state.change.logger)
[2024-08-21 15:02:58,797] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 47 (state.change.logger)
[2024-08-21 15:02:59,176] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102) for 1 partitions (state.change.logger)
[2024-08-21 15:02:59,177] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 48 (state.change.logger)
[2024-08-21 15:02:59,201] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102) for 1 partitions (state.change.logger)
[2024-08-21 15:02:59,202] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 49 (state.change.logger)
[2024-08-21 15:02:59,231] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102) for 1 partitions (state.change.logger)
[2024-08-21 15:02:59,232] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 50 (state.change.logger)
[2024-08-21 15:03:10,598] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102) for 0 partitions (state.change.logger)
[2024-08-21 15:03:10,598] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(103) for 3 partitions (state.change.logger)
[2024-08-21 15:03:10,599] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 103 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-08-21 15:03:10,599] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 3 partitions (state.change.logger)
[2024-08-21 15:03:10,602] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 52 (state.change.logger)
[2024-08-21 15:03:10,972] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 1 partitions (state.change.logger)
[2024-08-21 15:03:10,973] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 53 (state.change.logger)
[2024-08-21 15:03:10,985] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 1 partitions (state.change.logger)
[2024-08-21 15:03:10,986] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 54 (state.change.logger)
[2024-08-21 15:03:11,003] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 1 partitions (state.change.logger)
[2024-08-21 15:03:11,004] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 55 (state.change.logger)
[2024-08-21 15:05:50,905] INFO [Controller id=101 epoch=1] Changed partition topic1-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=102, leaderEpoch=3, isrWithBrokerEpoch=List(BrokerState(brokerId=101, brokerEpoch=-1), BrokerState(brokerId=102, brokerEpoch=-1), BrokerState(brokerId=103, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=5) (state.change.logger)
[2024-08-21 15:05:50,906] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 101 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 15:05:50,906] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 102 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 15:05:50,906] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 103 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 15:05:50,906] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 1 partitions (state.change.logger)
[2024-08-21 15:05:50,906] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 56 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 15:05:50,906] INFO [Broker id=101] Follower topic1-1 starts at leader epoch 3 from offset 0 with partition epoch 5 and high watermark 0. Current leader is 102. Previous leader Some(102) and previous leader epoch was 3. (state.change.logger)
[2024-08-21 15:05:50,907] INFO [Broker id=101] Stopped fetchers as part of become-follower request from controller 101 epoch 1 with correlation id 56 for 1 partitions (state.change.logger)
[2024-08-21 15:05:50,912] INFO [Broker id=101] Finished LeaderAndIsr request in 6ms correlationId 56 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 15:05:50,913] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 57 (state.change.logger)
[2024-08-21 15:05:50,919] INFO [Controller id=101 epoch=1] Changed partition topic1-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=103, leaderEpoch=3, isrWithBrokerEpoch=List(BrokerState(brokerId=101, brokerEpoch=-1), BrokerState(brokerId=102, brokerEpoch=-1), BrokerState(brokerId=103, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=5) (state.change.logger)
[2024-08-21 15:05:50,919] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 101 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 15:05:50,920] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 102 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 15:05:50,920] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 103 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 15:05:50,920] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 1 partitions (state.change.logger)
[2024-08-21 15:05:50,920] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 58 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 15:05:50,921] INFO [Broker id=101] Follower topic1-0 starts at leader epoch 3 from offset 3 with partition epoch 5 and high watermark 3. Current leader is 103. Previous leader Some(103) and previous leader epoch was 3. (state.change.logger)
[2024-08-21 15:05:50,921] INFO [Broker id=101] Stopped fetchers as part of become-follower request from controller 101 epoch 1 with correlation id 58 for 1 partitions (state.change.logger)
[2024-08-21 15:05:50,926] INFO [Broker id=101] Finished LeaderAndIsr request in 6ms correlationId 58 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 15:05:50,927] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 59 (state.change.logger)
[2024-08-21 15:15:57,339] INFO [Controller id=101 epoch=1] Changed partition topic1-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=102, leaderEpoch=4, isrWithBrokerEpoch=List(BrokerState(brokerId=101, brokerEpoch=-1), BrokerState(brokerId=102, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2024-08-21 15:15:57,339] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 101 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 15:15:57,339] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 102 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 15:15:57,339] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 103 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 15:15:57,339] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 1 partitions (state.change.logger)
[2024-08-21 15:15:57,340] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 15:15:57,340] INFO [Controller id=101 epoch=1] Sending StopReplica request for 2 replicas to broker 103 (state.change.logger)
[2024-08-21 15:15:57,342] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 60 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 15:15:57,342] INFO [Broker id=101] Follower topic1-0 starts at leader epoch 4 from offset 4382 with partition epoch 6 and high watermark 4382. Current leader is 102. Previous leader Some(102) and previous leader epoch was 4. (state.change.logger)
[2024-08-21 15:15:57,342] INFO [Broker id=101] Stopped fetchers as part of become-follower request from controller 101 epoch 1 with correlation id 60 for 1 partitions (state.change.logger)
[2024-08-21 15:15:57,347] INFO [Broker id=101] Finished LeaderAndIsr request in 5ms correlationId 60 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 15:15:57,352] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 61 (state.change.logger)
[2024-08-21 15:15:57,357] INFO [Controller id=101 epoch=1] Partition topic1-1 state changed to (Leader:102,ISR:101,102,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:1) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:15:57,358] INFO [Controller id=101 epoch=1] Partition topic1-2 state changed to (Leader:101,ISR:101,102,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:1) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:15:57,358] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 101 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 15:15:57,359] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 102 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 15:15:57,359] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 2 partitions (state.change.logger)
[2024-08-21 15:15:57,359] INFO [Controller id=101 epoch=1] Sending StopReplica request for 2 replicas to broker 103 (state.change.logger)
[2024-08-21 15:15:57,359] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 62 from controller 101 for 2 partitions (state.change.logger)
[2024-08-21 15:15:57,359] INFO [Broker id=101] Stopped fetchers as part of LeaderAndIsr request correlationId 62 from controller 101 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-08-21 15:15:57,360] INFO [Broker id=101] Leader topic1-2 with topic id Some(vME4OcIKTTO1lNGoKNRTqg) starts at leader epoch 3 from offset 0 with partition epoch 5, high watermark 0, ISR [101,102], adding replicas [] and removing replicas [] . Previous leader Some(101) and previous leader epoch was 2. (state.change.logger)
[2024-08-21 15:15:57,377] INFO [Broker id=101] Follower topic1-1 starts at leader epoch 4 from offset 0 with partition epoch 6 and high watermark 0. Current leader is 102. Previous leader Some(102) and previous leader epoch was 4. (state.change.logger)
[2024-08-21 15:15:57,378] INFO [Broker id=101] Stopped fetchers as part of become-follower request from controller 101 epoch 1 with correlation id 62 for 1 partitions (state.change.logger)
[2024-08-21 15:15:57,378] INFO [Broker id=101] Finished LeaderAndIsr request in 19ms correlationId 62 from controller 101 for 2 partitions (state.change.logger)
[2024-08-21 15:15:57,381] INFO [Broker id=101] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 63 (state.change.logger)
[2024-08-21 15:15:57,594] INFO [Controller id=101 epoch=1] Partition topic1-1 state changed to (Leader:102,ISR:101,102,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:1) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:15:57,594] INFO [Controller id=101 epoch=1] Partition topic1-0 state changed to (Leader:102,ISR:101,102,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:1) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:15:57,594] INFO [Controller id=101 epoch=1] Partition topic1-2 state changed to (Leader:101,ISR:101,102,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:1) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:15:57,594] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 101 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-08-21 15:15:57,595] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 102 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2024-08-21 15:15:57,595] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102) for 3 partitions (state.change.logger)
[2024-08-21 15:15:57,595] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 64 from controller 101 for 3 partitions (state.change.logger)
[2024-08-21 15:15:57,595] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 101 with correlation id 64 epoch 1 for partition topic1-1 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2024-08-21 15:15:57,595] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 101 with correlation id 64 epoch 1 for partition topic1-0 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2024-08-21 15:15:57,595] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 101 with correlation id 64 epoch 1 for partition topic1-2 since its associated leader epoch 3 matches the current leader epoch (state.change.logger)
[2024-08-21 15:15:57,595] INFO [Broker id=101] Finished LeaderAndIsr request in 0ms correlationId 64 from controller 101 for 3 partitions (state.change.logger)
[2024-08-21 15:15:57,596] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 65 (state.change.logger)
[2024-08-21 15:16:51,712] INFO [Controller id=101 epoch=1] Changed partition topic1-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=101, leaderEpoch=5, isrWithBrokerEpoch=List(BrokerState(brokerId=101, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=7) (state.change.logger)
[2024-08-21 15:16:51,712] INFO [Controller id=101 epoch=1] Changed partition topic1-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=101, leaderEpoch=5, isrWithBrokerEpoch=List(BrokerState(brokerId=101, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=7) (state.change.logger)
[2024-08-21 15:16:51,713] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 101 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 15:16:51,713] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 102 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2024-08-21 15:16:51,713] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102) for 2 partitions (state.change.logger)
[2024-08-21 15:16:51,713] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 66 from controller 101 for 2 partitions (state.change.logger)
[2024-08-21 15:16:51,714] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 15:16:51,714] INFO [Controller id=101 epoch=1] Sending StopReplica request for 1 replicas to broker 102 (state.change.logger)
[2024-08-21 15:16:51,714] INFO [Broker id=101] Stopped fetchers as part of LeaderAndIsr request correlationId 66 from controller 101 epoch 1 as part of the become-leader transition for 2 partitions (state.change.logger)
[2024-08-21 15:16:51,715] INFO [Broker id=101] Leader topic1-1 with topic id Some(vME4OcIKTTO1lNGoKNRTqg) starts at leader epoch 5 from offset 0 with partition epoch 7, high watermark 0, ISR [101], adding replicas [] and removing replicas [] . Previous leader Some(102) and previous leader epoch was 4. (state.change.logger)
[2024-08-21 15:16:51,729] INFO [Broker id=101] Leader topic1-0 with topic id Some(vME4OcIKTTO1lNGoKNRTqg) starts at leader epoch 5 from offset 4437 with partition epoch 7, high watermark 4436, ISR [101], adding replicas [] and removing replicas [] . Previous leader Some(102) and previous leader epoch was 4. (state.change.logger)
[2024-08-21 15:16:51,740] INFO [Controller id=101 epoch=1] Partition topic1-2 state changed to (Leader:101,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:1) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:16:51,741] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 101 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 15:16:51,741] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101, 102) for 1 partitions (state.change.logger)
[2024-08-21 15:16:51,741] INFO [Controller id=101 epoch=1] Sending StopReplica request for 1 replicas to broker 102 (state.change.logger)
[2024-08-21 15:16:51,753] INFO [Broker id=101] Finished LeaderAndIsr request in 40ms correlationId 66 from controller 101 for 2 partitions (state.change.logger)
[2024-08-21 15:16:51,754] INFO [Broker id=101] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 67 (state.change.logger)
[2024-08-21 15:16:51,755] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 68 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 15:16:51,756] INFO [Broker id=101] Stopped fetchers as part of LeaderAndIsr request correlationId 68 from controller 101 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-08-21 15:16:51,756] INFO [Broker id=101] Leader topic1-2 with topic id Some(vME4OcIKTTO1lNGoKNRTqg) starts at leader epoch 4 from offset 0 with partition epoch 6, high watermark 0, ISR [101], adding replicas [] and removing replicas [] . Previous leader Some(101) and previous leader epoch was 3. (state.change.logger)
[2024-08-21 15:16:51,767] INFO [Broker id=101] Finished LeaderAndIsr request in 12ms correlationId 68 from controller 101 for 1 partitions (state.change.logger)
[2024-08-21 15:16:51,768] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 69 (state.change.logger)
[2024-08-21 15:16:51,967] INFO [Controller id=101 epoch=1] Partition topic1-1 state changed to (Leader:101,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:1) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:16:51,967] INFO [Controller id=101 epoch=1] Partition topic1-0 state changed to (Leader:101,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:1) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:16:51,967] INFO [Controller id=101 epoch=1] Partition topic1-2 state changed to (Leader:101,ISR:101,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:1) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-08-21 15:16:51,967] INFO [Controller id=101 epoch=1] Sending LeaderAndIsr request to broker 101 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-08-21 15:16:51,967] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet(101) for 3 partitions (state.change.logger)
[2024-08-21 15:16:51,968] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 70 from controller 101 for 3 partitions (state.change.logger)
[2024-08-21 15:16:51,968] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 101 with correlation id 70 epoch 1 for partition topic1-1 since its associated leader epoch 5 matches the current leader epoch (state.change.logger)
[2024-08-21 15:16:51,968] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 101 with correlation id 70 epoch 1 for partition topic1-0 since its associated leader epoch 5 matches the current leader epoch (state.change.logger)
[2024-08-21 15:16:51,968] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 101 with correlation id 70 epoch 1 for partition topic1-2 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2024-08-21 15:16:51,968] INFO [Broker id=101] Finished LeaderAndIsr request in 0ms correlationId 70 from controller 101 for 3 partitions (state.change.logger)
[2024-08-21 15:16:51,969] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 71 (state.change.logger)
[2024-08-21 15:17:22,958] ERROR [Controller id=101 epoch=1] Controller 101 epoch 1 failed to change state for partition topic1-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:135)
[2024-08-21 15:17:22,958] ERROR [Controller id=101 epoch=1] Controller 101 epoch 1 failed to change state for partition topic1-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:135)
[2024-08-21 15:17:22,959] ERROR [Controller id=101 epoch=1] Controller 101 epoch 1 failed to change state for partition topic1-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:135)
[2024-08-21 15:17:22,959] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 15:17:22,959] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 15:17:27,967] ERROR [Controller id=101 epoch=1] Controller 101 epoch 1 failed to change state for partition topic1-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:135)
[2024-08-21 15:17:27,968] ERROR [Controller id=101 epoch=1] Controller 101 epoch 1 failed to change state for partition topic1-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:135)
[2024-08-21 15:17:27,968] ERROR [Controller id=101 epoch=1] Controller 101 epoch 1 failed to change state for partition topic1-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:135)
[2024-08-21 15:17:27,968] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 15:17:27,968] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 15:17:32,972] ERROR [Controller id=101 epoch=1] Controller 101 epoch 1 failed to change state for partition topic1-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:135)
[2024-08-21 15:17:32,972] ERROR [Controller id=101 epoch=1] Controller 101 epoch 1 failed to change state for partition topic1-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:135)
[2024-08-21 15:17:32,973] ERROR [Controller id=101 epoch=1] Controller 101 epoch 1 failed to change state for partition topic1-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:135)
[2024-08-21 15:17:32,973] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-08-21 15:17:32,973] INFO [Controller id=101 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
